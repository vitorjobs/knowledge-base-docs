<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DocumentaÃ§Ã£o do Projeto Ansible - Monitoring Stack | DocumentaÃ§Ã£o Geral</title>
    <meta name="description" content="Estudos Diversos em Tecnologia">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style.CF0zJ56n.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CvWNKUV8.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Be2-VvxL.js">
    <link rel="modulepreload" href="/assets/chunks/framework.D70b1pOo.js">
    <link rel="modulepreload" href="/assets/Ansible_Projects_MonitoringWithDockerComposer_README.md.DGd7cPdb.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle has-sidebar" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>DocumentaÃ§Ã£o Geral</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>InÃ­cio</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/markdown-examples.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Docs</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-db738f89><span class="vpi-align-left menu-icon" data-v-db738f89></span><span class="menu-text" data-v-db738f89>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1df9f90f data-v-af661f50><div class="curtain" data-v-af661f50></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-af661f50><span class="visually-hidden" id="sidebar-aria-label" data-v-af661f50> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0 has-active" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Ansible</h2><!----></div><div class="items" data-v-d81de50c><!--[--><section class="VPSidebarItem level-1 collapsible collapsed is-link has-active" data-v-d81de50c data-v-d81de50c><div class="item" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/Ansible/index.html" rel="noopener noreferrer" data-v-d81de50c><!--[--><h3 class="text" data-v-d81de50c>Projetos e Exemplos</h3><!--]--></a><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-d81de50c><span class="vpi-chevron-right caret-icon" data-v-d81de50c></span></div></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-2 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/Ansible/Projects/MonitoringWithDockerComposer/README.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Stack de Monitoramento</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/Ansible/comandos.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>Comandos Ansible</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>AWS</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/aws/index.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>ConfiguraÃ§Ã£o CLI AWS</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-8d50c081><section class="VPSidebarItem level-0" data-v-8d50c081 data-v-d81de50c><div class="item" role="button" tabindex="0" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><h2 class="text" data-v-d81de50c>Terraform</h2><!----></div><div class="items" data-v-d81de50c><!--[--><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/terraform/index.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>InstalaÃ§Ã£o Terraform</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-d81de50c data-v-d81de50c><div class="item" data-v-d81de50c><div class="indicator" data-v-d81de50c></div><a class="VPLink link link" href="/terraform/EC2/index.html" data-v-d81de50c><!--[--><p class="text" data-v-d81de50c>LanÃ§ar InstÃ¢ncia EC2</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-sidebar has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _Ansible_Projects_MonitoringWithDockerComposer_README" data-v-7011f0d8><div><h1 id="documentacao-do-projeto-ansible-monitoring-stack" tabindex="-1">DocumentaÃ§Ã£o do Projeto Ansible - Monitoring Stack <a class="header-anchor" href="#documentacao-do-projeto-ansible-monitoring-stack" aria-label="Permalink to â€œDocumentaÃ§Ã£o do Projeto Ansible - Monitoring Stackâ€">â€‹</a></h1><h2 id="ğŸ“‹-visao-geral" tabindex="-1">ğŸ“‹ VisÃ£o Geral <a class="header-anchor" href="#ğŸ“‹-visao-geral" aria-label="Permalink to â€œğŸ“‹ VisÃ£o Geralâ€">â€‹</a></h2><p>Este projeto Ansible automatiza a criaÃ§Ã£o e gerenciamento de uma stack de monitoramento baseada em Docker, integrando <strong>Prometheus</strong> para coleta de mÃ©tricas e <strong>Grafana</strong> para visualizaÃ§Ã£o de dados. O projeto segue as melhores prÃ¡ticas do Ansible, incluindo uso de roles, templates Jinja2 e variÃ¡veis centralizadas.</p><h3 id="objetivo-principal" tabindex="-1">Objetivo Principal <a class="header-anchor" href="#objetivo-principal" aria-label="Permalink to â€œObjetivo Principalâ€">â€‹</a></h3><p>Provisionar rapidamente uma infraestrutura de monitoramento dockerizada em mÃ¡quinas locais ou remotas atravÃ©s de playbooks Ansible, facilitando a gestÃ£o de containers e configuraÃ§Ãµes de forma idempotente.</p><hr><h2 id="ğŸ“-estrutura-do-projeto" tabindex="-1">ğŸ“ Estrutura do Projeto <a class="header-anchor" href="#ğŸ“-estrutura-do-projeto" aria-label="Permalink to â€œğŸ“ Estrutura do Projetoâ€">â€‹</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>monitoring-ansible/</span></span>
<span class="line"><span>â”œâ”€â”€ ansible.cfg                          # ConfiguraÃ§Ã£o global do Ansible</span></span>
<span class="line"><span>â”œâ”€â”€ playbook_create.yml                  # Playbook para criar stack</span></span>
<span class="line"><span>â”œâ”€â”€ playbook_destroy.yml                 # Playbook para destruir stack</span></span>
<span class="line"><span>â”œâ”€â”€ test-vars.yml                        # Playbook para testar variÃ¡veis</span></span>
<span class="line"><span>â”œâ”€â”€ README.MD                            # DocumentaÃ§Ã£o inicial</span></span>
<span class="line"><span>â”œâ”€â”€ DOCUMENTACAO.md                      # Esta documentaÃ§Ã£o</span></span>
<span class="line"><span>â”œâ”€â”€ ansible.cfg                          # ConfiguraÃ§Ã£o do Ansible</span></span>
<span class="line"><span>â”œâ”€â”€ inventory/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ hosts.ini                        # InventÃ¡rio de hosts</span></span>
<span class="line"><span>â”œâ”€â”€ group_vars/</span></span>
<span class="line"><span>â”‚   â””â”€â”€ all.yml                          # VariÃ¡veis aplicadas a todos os hosts</span></span>
<span class="line"><span>â””â”€â”€ roles/</span></span>
<span class="line"><span>    â””â”€â”€ monitoring/</span></span>
<span class="line"><span>        â”œâ”€â”€ tasks/</span></span>
<span class="line"><span>        â”‚   â”œâ”€â”€ main.yml                 # Tasks principais de criaÃ§Ã£o</span></span>
<span class="line"><span>        â”‚   â””â”€â”€ destroy_containers.yml   # Tasks de destruiÃ§Ã£o</span></span>
<span class="line"><span>        â”œâ”€â”€ templates/</span></span>
<span class="line"><span>        â”‚   â”œâ”€â”€ docker-compose.yml.j2    # Template Docker Compose</span></span>
<span class="line"><span>        â”‚   â””â”€â”€ prometheus.yml.j2        # Template Prometheus</span></span>
<span class="line"><span>        â””â”€â”€ files/                       # DiretÃ³rio para arquivos estÃ¡ticos (vazio)</span></span></code></pre></div><hr><h2 id="ğŸ“„-descricao-detalhada-dos-arquivos" tabindex="-1">ğŸ“„ DescriÃ§Ã£o Detalhada dos Arquivos <a class="header-anchor" href="#ğŸ“„-descricao-detalhada-dos-arquivos" aria-label="Permalink to â€œğŸ“„ DescriÃ§Ã£o Detalhada dos Arquivosâ€">â€‹</a></h2><h3 id="_1-ansible-cfg" tabindex="-1">1. <strong>ansible.cfg</strong> <a class="header-anchor" href="#_1-ansible-cfg" aria-label="Permalink to â€œ1. ansible.cfgâ€">â€‹</a></h3><p><strong>Responsabilidade:</strong> Arquivo de configuraÃ§Ã£o global do Ansible que define comportamentos padrÃ£o para toda a execuÃ§Ã£o.</p><p><strong>ConteÃºdo:</strong></p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[defaults]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">inventory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = inventory/hosts.ini         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Arquivo de inventÃ¡rio padrÃ£o</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">host_key_checking</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = False               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Desativa verificaÃ§Ã£o de chaves SSH</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interpreter_python</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = auto               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Detecta automaticamente Python disponÃ­vel</span></span></code></pre></div><p><strong>Papel:</strong></p><ul><li>Define o inventÃ¡rio padrÃ£o para que nÃ£o seja necessÃ¡rio especificÃ¡-lo em cada comando</li><li>Desativa a verificaÃ§Ã£o de chaves SSH para evitar prompts interativos</li><li>Garante compatibilidade entre diferentes versÃµes de Python</li></ul><p><strong>Boas PrÃ¡ticas Aplicadas:</strong></p><ul><li>âœ… ConfiguraÃ§Ã£o centralizada evita repetiÃ§Ã£o em comandos</li><li>âœ… <code>interpreter_python = auto</code> aumenta compatibilidade</li></ul><hr><h3 id="_2-inventory-hosts-ini" tabindex="-1">2. <strong>inventory/hosts.ini</strong> <a class="header-anchor" href="#_2-inventory-hosts-ini" aria-label="Permalink to â€œ2. inventory/hosts.iniâ€">â€‹</a></h3><p><strong>Responsabilidade:</strong> Define os hosts alvo e suas configuraÃ§Ãµes de conexÃ£o.</p><p><strong>ConteÃºdo:</strong></p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[monitoring]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=local</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=local </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_python_interpreter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/usr/bin/python3</span></span></code></pre></div><p><strong>Papel:</strong></p><ul><li>Agrupa hosts sob o grupo <code>monitoring</code></li><li>Define <code>localhost</code> como alvo com conexÃ£o local (sem SSH)</li><li>Especifica o interpretador Python da mÃ¡quina local</li></ul><p><strong>Boas PrÃ¡ticas Aplicadas:</strong></p><ul><li>âœ… Uso de grupos para organizar hosts</li><li>âœ… Flexibilidade para adicionar hosts remotos</li><li>âœ… ConfiguraÃ§Ã£o especÃ­fica do interpretador Python</li></ul><p><strong>Como Adicionar um Host Remoto:</strong></p><div class="language-ini"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[monitoring]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">localhost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_connection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=local</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">remote_host </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_host</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=192.168.1.100 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_user</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=ubuntu </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ansible_ssh_private_key_file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=~/.ssh/id_rsa</span></span></code></pre></div><hr><h3 id="_3-group-vars-all-yml" tabindex="-1">3. <strong>group_vars/all.yml</strong> <a class="header-anchor" href="#_3-group-vars-all-yml" aria-label="Permalink to â€œ3. group_vars/all.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="group_vars/all.yml">group_vars/all.yml</a></p><p><strong>Responsabilidade:</strong> Define variÃ¡veis aplicadas a <strong>todos os hosts</strong> do inventÃ¡rio.</p><p><strong>Papel:</strong></p><ul><li>Centraliza configuraÃ§Ãµes de ambiente</li><li>Define parÃ¢metros dos containers (imagens, portas, IPs)</li><li>Especifica volumes Docker e configuraÃ§Ãµes de rede</li><li>Fornece valores reutilizÃ¡veis para templates</li></ul><p><strong>VariÃ¡veis Principais:</strong></p><table tabindex="0"><thead><tr><th>VariÃ¡vel</th><th>DescriÃ§Ã£o</th><th>Valor PadrÃ£o</th></tr></thead><tbody><tr><td><code>project_name</code></td><td>Nome do projeto</td><td><code>monitoring</code></td></tr><tr><td><code>project_path</code></td><td>Caminho do projeto na mÃ¡quina</td><td><code>/home//monitoring</code></td></tr><tr><td><code>docker_network.subnet</code></td><td>Subnet da rede Docker</td><td><code>172.30.0.0/16</code></td></tr><tr><td><code>containers.prometheus.image</code></td><td>Imagem Docker Prometheus</td><td><code>prom/prometheus:latest</code></td></tr><tr><td><code>containers.prometheus.ip_address</code></td><td>IP fixo Prometheus</td><td><code>172.30.0.10</code></td></tr><tr><td><code>containers.prometheus.host_port</code></td><td>Porta exposta Prometheus</td><td><code>9090</code></td></tr><tr><td><code>containers.grafana.image</code></td><td>Imagem Docker Grafana</td><td><code>grafana/grafana:latest</code></td></tr><tr><td><code>containers.grafana.ip_address</code></td><td>IP fixo Grafana</td><td><code>172.30.0.20</code></td></tr><tr><td><code>containers.grafana.host_port</code></td><td>Porta exposta Grafana</td><td><code>3000</code></td></tr><tr><td><code>containers.grafana.admin_user</code></td><td>UsuÃ¡rio admin Grafana</td><td><code>admin</code></td></tr><tr><td><code>containers.grafana.admin_password</code></td><td>Senha admin Grafana</td><td><code>admin123</code></td></tr><tr><td><code>docker_volumes</code></td><td>Lista de volumes Docker</td><td><code>[&quot;prometheus_data&quot;, &quot;grafana_data&quot;]</code></td></tr></tbody></table><p><strong>Boas PrÃ¡ticas Aplicadas:</strong></p><ul><li>âœ… SeparaÃ§Ã£o de configuraÃ§Ãµes de cÃ³digo</li><li>âœ… Uso de variÃ¡veis dinÃ¢micas (ex: <code></code>)</li><li>âœ… Estrutura hierÃ¡rquica com dicionÃ¡rios</li><li>âš ï¸ <strong>SeguranÃ§a:</strong> Senhas em arquivo de configuraÃ§Ã£o (usar Vault em produÃ§Ã£o!)</li></ul><p><strong>Como Usar em ProduÃ§Ã£o:</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Encriptar variÃ¡veis sensÃ­veis com Ansible Vault</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-vault</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> encrypt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group_vars/all.yml</span></span></code></pre></div><hr><h3 id="_4-playbook-create-yml" tabindex="-1">4. <strong>playbook_create.yml</strong> <a class="header-anchor" href="#_4-playbook-create-yml" aria-label="Permalink to â€œ4. playbook_create.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="playbook_create.yml">playbook_create.yml</a></p><p><strong>Responsabilidade:</strong> Playbook principal que orquestra a criaÃ§Ã£o da stack de monitoramento.</p><p><strong>Papel:</strong></p><ul><li>Executa todas as tasks do role <code>monitoring</code></li><li>Exibe informaÃ§Ãµes de diagnÃ³stico e troubleshooting</li><li>Fornece comandos manual para verificaÃ§Ã£o</li></ul><p><strong>Estrutura:</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Setup Stack de Monitoramento com Docker Compose</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">monitoring</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                      # Alvo: grupo monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  roles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">monitoring</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # Carrega o role monitoring</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  post_tasks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Exibir resumo e troubleshooting</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      debug</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                         # Exibe instruÃ§Ãµes pÃ³s-criaÃ§Ã£o</span></span></code></pre></div><p><strong>O que Acontece na ExecuÃ§Ã£o:</strong></p><ol><li>âœ… Cria diretÃ³rio do projeto</li><li>âœ… Cria diretÃ³rio de configuraÃ§Ã£o Prometheus</li><li>âœ… Renderiza <code>prometheus.yml</code> a partir do template</li><li>âœ… Renderiza <code>docker-compose.yml</code> a partir do template</li><li>âœ… Executa <code>docker compose up -d</code> para iniciar containers</li><li>âœ… Exibe mensagens de diagnÃ³stico</li></ol><hr><h3 id="_5-playbook-destroy-yml" tabindex="-1">5. <strong>playbook_destroy.yml</strong> <a class="header-anchor" href="#_5-playbook-destroy-yml" aria-label="Permalink to â€œ5. playbook_destroy.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="playbook_destroy.yml">playbook_destroy.yml</a></p><p><strong>Responsabilidade:</strong> Playbook para limpeza completa da stack de monitoramento.</p><p><strong>Papel:</strong></p><ul><li>Remove containers, redes e volumes Docker</li><li>Deleta o diretÃ³rio do projeto</li><li>Fornece feedback da operaÃ§Ã£o</li></ul><p><strong>Estrutura:</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Destruir stack de monitoramento (Docker Compose)</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  vars</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    project_path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/home/{{ ansible_user }}/{{ project_name }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tasks</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">include_role</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">monitoring</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        tasks_from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">destroy_containers.yml</span></span></code></pre></div><hr><h3 id="_6-test-vars-yml" tabindex="-1">6. <strong>test-vars.yml</strong> <a class="header-anchor" href="#_6-test-vars-yml" aria-label="Permalink to â€œ6. test-vars.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="test-vars.yml">test-vars.yml</a></p><p><strong>Responsabilidade:</strong> Playbook para validaÃ§Ã£o e debug de variÃ¡veis.</p><p><strong>Papel:</strong></p><ul><li>Verifica se as variÃ¡veis estÃ£o sendo carregadas corretamente</li><li>Ãštil para troubleshooting e desenvolvimento</li></ul><p><strong>Como Usar:</strong></p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-vars.yml</span></span></code></pre></div><hr><h3 id="_7-roles-monitoring-tasks-main-yml" tabindex="-1">7. <strong>roles/monitoring/tasks/main.yml</strong> <a class="header-anchor" href="#_7-roles-monitoring-tasks-main-yml" aria-label="Permalink to â€œ7. roles/monitoring/tasks/main.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="roles/monitoring/tasks/main.yml">roles/monitoring/tasks/main.yml</a></p><p><strong>Responsabilidade:</strong> Define as tasks principais para criar a stack de monitoramento.</p><p><strong>Tasks Executadas:</strong></p><table tabindex="0"><thead><tr><th>#</th><th>Task</th><th>MÃ³dulo</th><th>DescriÃ§Ã£o</th></tr></thead><tbody><tr><td>1</td><td>Criar diretÃ³rio do projeto</td><td><code>file</code></td><td>Cria <code>/home/user/monitoring</code></td></tr><tr><td>2</td><td>Criar diretÃ³rio Prometheus</td><td><code>file</code></td><td>Cria <code>/home/user/monitoring/prometheus</code></td></tr><tr><td>3</td><td>Renderizar prometheus.yml</td><td><code>template</code></td><td>Gera config Prometheus dinamicamente</td></tr><tr><td>4</td><td>Renderizar docker-compose.yml</td><td><code>template</code></td><td>Gera docker-compose dinamicamente</td></tr><tr><td>5</td><td>Subir stack</td><td><code>command</code></td><td>Executa <code>docker compose up -d</code></td></tr><tr><td>6</td><td>Exibir resumo</td><td><code>debug</code></td><td>Mostra URLs e informaÃ§Ãµes</td></tr></tbody></table><p><strong>MÃ³dulos Utilizados:</strong></p><ul><li><code>file</code>: Gerenciar arquivos e diretÃ³rios</li><li><code>template</code>: Renderizar templates Jinja2</li><li><code>command</code>: Executar comandos shell</li><li><code>debug</code>: Exibir mensagens</li></ul><hr><h3 id="_8-roles-monitoring-tasks-destroy-containers-yml" tabindex="-1">8. <strong>roles/monitoring/tasks/destroy_containers.yml</strong> <a class="header-anchor" href="#_8-roles-monitoring-tasks-destroy-containers-yml" aria-label="Permalink to â€œ8. roles/monitoring/tasks/destroy_containers.ymlâ€">â€‹</a></h3><p><strong>LocalizaÃ§Ã£o:</strong> <a href="roles/monitoring/tasks/destroy_containers.yml">roles/monitoring/tasks/destroy_containers.yml</a></p><p><strong>Responsabilidade:</strong> Define as tasks para destruiÃ§Ã£o da stack.</p><p><strong>Tasks Executadas:</strong></p><table tabindex="0"><thead><tr><th>#</th><th>Task</th><th>MÃ³dulo</th><th>DescriÃ§Ã£o</th></tr></thead><tbody><tr><td>1</td><td>Verificar diretÃ³rio</td><td><code>stat</code></td><td>Verifica se <code>/home/user/monitoring</code> existe</td></tr><tr><td>2</td><td>Parar containers</td><td><code>command</code></td><td>Executa <code>docker compose down -v</code></td></tr><tr><td>3</td><td>Remover diretÃ³rio</td><td><code>file</code></td><td>Deleta o diretÃ³rio inteiro</td></tr><tr><td>4</td><td>Exibir resumo</td><td><code>debug</code></td><td>Confirma remoÃ§Ã£o</td></tr></tbody></table><p><strong>Flags Importantes:</strong></p><ul><li><code>-v</code>: Remove volumes associados</li><li><code>--remove-orphans</code>: Remove containers Ã³rfÃ£os</li></ul><hr><h3 id="_9-roles-monitoring-templates-docker-compose-yml-j2" tabindex="-1">9. <strong>roles/monitoring/templates/docker-compose.yml.j2</strong> <a class="header-anchor" href="#_9-roles-monitoring-templates-docker-compose-yml-j2" aria-label="Permalink to â€œ9. roles/monitoring/templates/docker-compose.yml.j2â€">â€‹</a></h3><p><strong>Responsabilidade:</strong> Template Jinja2 para gerar o arquivo <code>docker-compose.yml</code>.</p><p><strong>Papel:</strong></p><ul><li>Define serviÃ§os Prometheus e Grafana</li><li>Configura volumes, redes, portas e variÃ¡veis de ambiente</li><li>Renderizado dinamicamente com valores de <code>all.yml</code></li></ul><p><strong>Componentes:</strong></p><p><strong>Volumes:</strong></p><div class="language-jinja2"><button title="Copy Code" class="copy"></button><span class="lang">jinja2</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>volumes:</span></span>
<span class="line"><span>{% for volume in docker_volumes %}</span></span>
<span class="line"><span>  {{ volume }}:</span></span>
<span class="line"><span>{% endfor %}</span></span></code></pre></div><p>Gera volumes: <code>prometheus_data:</code> e <code>grafana_data:</code></p><p><strong>Rede:</strong></p><div class="language-jinja2"><button title="Copy Code" class="copy"></button><span class="lang">jinja2</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>networks:</span></span>
<span class="line"><span>  monitoring:</span></span>
<span class="line"><span>    driver: bridge</span></span>
<span class="line"><span>    ipam:</span></span>
<span class="line"><span>      config:</span></span>
<span class="line"><span>        - subnet: {{ docker_network.subnet }}</span></span></code></pre></div><p>Cria rede com subnet <code>172.30.0.0/16</code></p><p><strong>ServiÃ§o Prometheus:</strong></p><ul><li>Imagem: <code>prom/prometheus:latest</code></li><li>IP: <code>172.30.0.10</code></li><li>Porta: <code>9090:9090</code></li><li>Volume: <code>./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml</code></li><li>Restart: <code>unless-stopped</code></li></ul><p><strong>ServiÃ§o Grafana:</strong></p><ul><li>Imagem: <code>grafana/grafana:latest</code></li><li>IP: <code>172.30.0.20</code></li><li>Porta: <code>3000:3000</code></li><li>UsuÃ¡rio Admin: <code>admin</code></li><li>Senha Admin: <code>admin123</code></li><li>DependÃªncia: Prometheus</li><li>Restart: <code>unless-stopped</code></li></ul><hr><h3 id="_10-roles-monitoring-templates-prometheus-yml-j2" tabindex="-1">10. <strong>roles/monitoring/templates/prometheus.yml.j2</strong> <a class="header-anchor" href="#_10-roles-monitoring-templates-prometheus-yml-j2" aria-label="Permalink to â€œ10. roles/monitoring/templates/prometheus.yml.j2â€">â€‹</a></h3><p><strong>Responsabilidade:</strong> Template Jinja2 para gerar a configuraÃ§Ã£o do Prometheus.</p><p><strong>Papel:</strong></p><ul><li>Define intervalo de scrape (15 segundos)</li><li>Especifica o job <code>prometheus</code> para auto-monitoramento</li><li>ConfigurÃ¡vel para adicionar mais targets</li></ul><p><strong>ConteÃºdo Gerado:</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">global</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  scrape_interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">15s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">scrape_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">job_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prometheus&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    static_configs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">targets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost:9090&quot;</span></span></code></pre></div><hr><h2 id="ğŸ”„-relacionamentos-entre-arquivos" tabindex="-1">ğŸ”„ Relacionamentos Entre Arquivos <a class="header-anchor" href="#ğŸ”„-relacionamentos-entre-arquivos" aria-label="Permalink to â€œğŸ”„ Relacionamentos Entre Arquivosâ€">â€‹</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>ansible.cfg</span></span>
<span class="line"><span>    â†“</span></span>
<span class="line"><span>    â””â”€â†’ Referencia: inventory/hosts.ini</span></span>
<span class="line"><span>            â†“</span></span>
<span class="line"><span>            â””â”€â†’ Grupo: [monitoring]</span></span>
<span class="line"><span>                    â†“</span></span>
<span class="line"><span>                    â””â”€â†’ Usa variÃ¡veis: group_vars/all.yml</span></span>
<span class="line"><span>                            â†“</span></span>
<span class="line"><span>                            â”œâ”€â†’ playbook_create.yml</span></span>
<span class="line"><span>                            â”‚       â†“</span></span>
<span class="line"><span>                            â”‚       â””â”€â†’ Role: monitoring</span></span>
<span class="line"><span>                            â”‚               â†“</span></span>
<span class="line"><span>                            â”‚               â”œâ”€â†’ tasks/main.yml</span></span>
<span class="line"><span>                            â”‚               â”‚       â”œâ”€â†’ Template: docker-compose.yml.j2</span></span>
<span class="line"><span>                            â”‚               â”‚       â””â”€â†’ Template: prometheus.yml.j2</span></span>
<span class="line"><span>                            â”‚               â”‚</span></span>
<span class="line"><span>                            â”‚               â””â”€â†’ tasks/destroy_containers.yml</span></span>
<span class="line"><span>                            â”‚</span></span>
<span class="line"><span>                            â””â”€â†’ playbook_destroy.yml</span></span>
<span class="line"><span>                                    â†“</span></span>
<span class="line"><span>                                    â””â”€â†’ Role: monitoring</span></span>
<span class="line"><span>                                            â†“</span></span>
<span class="line"><span>                                            â””â”€â†’ tasks/destroy_containers.yml</span></span></code></pre></div><hr><h2 id="ğŸš€-guia-de-execucao" tabindex="-1">ğŸš€ Guia de ExecuÃ§Ã£o <a class="header-anchor" href="#ğŸš€-guia-de-execucao" aria-label="Permalink to â€œğŸš€ Guia de ExecuÃ§Ã£oâ€">â€‹</a></h2><h3 id="pre-requisitos" tabindex="-1">PrÃ©-requisitos <a class="header-anchor" href="#pre-requisitos" aria-label="Permalink to â€œPrÃ©-requisitosâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instalar Ansible (3.0+)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ansible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instalar Docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker.io</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Instalar Docker Compose</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># (Opcional) Instalar coleta community.docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-galaxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> collection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> community.docker</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Adicionar usuÃ¡rio ao grupo docker (para evitar sudo)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -aG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $USER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span></code></pre></div><h3 id="_1ï¸âƒ£-executar-o-playbook-de-criacao" tabindex="-1">1ï¸âƒ£ Executar o Playbook de CriaÃ§Ã£o <a class="header-anchor" href="#_1ï¸âƒ£-executar-o-playbook-de-criacao" aria-label="Permalink to â€œ1ï¸âƒ£ Executar o Playbook de CriaÃ§Ã£oâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ExecuÃ§Ã£o padrÃ£o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Com mais verbosidade (para debug)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Bem verboso (debug detalhado)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -vvv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Especificar inventÃ¡rio (se nÃ£o quiser usar o padrÃ£o)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Especificar tags (se implementadas)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --tags</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;setup&quot;</span></span></code></pre></div><p><strong>Esperado:</strong></p><ul><li>âœ… DiretÃ³rio <code>/home/user/monitoring/</code> criado</li><li>âœ… Arquivo <code>docker-compose.yml</code> gerado</li><li>âœ… Arquivo <code>prometheus/prometheus.yml</code> gerado</li><li>âœ… Containers Prometheus e Grafana inicializados</li><li>âœ… URLs de acesso exibidas no final</li></ul><h3 id="_2ï¸âƒ£-verificar-status-dos-containers" tabindex="-1">2ï¸âƒ£ Verificar Status dos Containers <a class="header-anchor" href="#_2ï¸âƒ£-verificar-status-dos-containers" aria-label="Permalink to â€œ2ï¸âƒ£ Verificar Status dos Containersâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Listar containers em execuÃ§Ã£o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ps</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ver logs dos containers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ver logs em tempo real</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Inspecionar container especÃ­fico</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inspect</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> prometheus_ansible</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verificar uso de recursos</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stats</span></span></code></pre></div><h3 id="_3ï¸âƒ£-acessar-as-interfaces-web" tabindex="-1">3ï¸âƒ£ Acessar as Interfaces Web <a class="header-anchor" href="#_3ï¸âƒ£-acessar-as-interfaces-web" aria-label="Permalink to â€œ3ï¸âƒ£ Acessar as Interfaces Webâ€">â€‹</a></h3><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>ğŸŸ¢ Prometheus:  http://localhost:9090</span></span>
<span class="line"><span>ğŸ”µ Grafana:     http://localhost:3000</span></span>
<span class="line"><span>   UsuÃ¡rio:     admin</span></span>
<span class="line"><span>   Senha:       admin123</span></span></code></pre></div><h3 id="_4ï¸âƒ£-testar-variaveis" tabindex="-1">4ï¸âƒ£ Testar VariÃ¡veis <a class="header-anchor" href="#_4ï¸âƒ£-testar-variaveis" aria-label="Permalink to â€œ4ï¸âƒ£ Testar VariÃ¡veisâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validar carregamento de variÃ¡veis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-vars.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Esperado:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;project_path: /home/guedes/monitoring&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># &quot;project_name: monitoring&quot;</span></span></code></pre></div><h3 id="_5ï¸âƒ£-executar-o-playbook-de-destruicao" tabindex="-1">5ï¸âƒ£ Executar o Playbook de DestruiÃ§Ã£o <a class="header-anchor" href="#_5ï¸âƒ£-executar-o-playbook-de-destruicao" aria-label="Permalink to â€œ5ï¸âƒ£ Executar o Playbook de DestruiÃ§Ã£oâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Remover toda a stack</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_destroy.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Esperado:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… Containers parados e removidos</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… Volumes removidos</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… Redes removidas</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… DiretÃ³rio deletado</span></span></code></pre></div><hr><h2 id="âœ…-validacao-e-testes" tabindex="-1">âœ… ValidaÃ§Ã£o e Testes <a class="header-anchor" href="#âœ…-validacao-e-testes" aria-label="Permalink to â€œâœ… ValidaÃ§Ã£o e Testesâ€">â€‹</a></h2><h3 id="syntax-check" tabindex="-1">Syntax Check <a class="header-anchor" href="#syntax-check" aria-label="Permalink to â€œSyntax Checkâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validar sintaxe de playbooks</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --syntax-check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --syntax-check</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_destroy.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validar sintaxe do inventÃ¡rio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-inventory</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Listar hosts que serÃ£o afetados</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-inventory</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list</span></span></code></pre></div><h3 id="dry-run-simular-execucao" tabindex="-1">Dry Run (Simular ExecuÃ§Ã£o) <a class="header-anchor" href="#dry-run-simular-execucao" aria-label="Permalink to â€œDry Run (Simular ExecuÃ§Ã£o)â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Executar em &quot;modo check&quot; sem fazer mudanÃ§as reais</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --check</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Com debug verbose</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --check</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Combinado com diff (mostra o que seria alterado)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --check</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --diff</span></span></code></pre></div><h3 id="validar-conectividade" tabindex="-1">Validar Conectividade <a class="header-anchor" href="#validar-conectividade" aria-label="Permalink to â€œValidar Conectividadeâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Testar conexÃ£o com hosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ping</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Coletar fatos sobre os hosts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setup</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Executar comando ad-hoc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> monitoring</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> inventory/hosts.ini</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -m</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> command</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;docker --version&quot;</span></span></code></pre></div><h3 id="validar-templates" tabindex="-1">Validar Templates <a class="header-anchor" href="#validar-templates" aria-label="Permalink to â€œValidar Templatesâ€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Renderizar template sem aplicar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --check</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --diff</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verificar arquivo gerado manualmente</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/prometheus/prometheus.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validar yaml do docker-compose</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span></code></pre></div><hr><h2 id="ğŸ”-boas-praticas-ansible" tabindex="-1">ğŸ” Boas PrÃ¡ticas Ansible <a class="header-anchor" href="#ğŸ”-boas-praticas-ansible" aria-label="Permalink to â€œğŸ” Boas PrÃ¡ticas Ansibleâ€">â€‹</a></h2><h3 id="_1-seguranca-gestao-de-senhas" tabindex="-1">1. <strong>SeguranÃ§a - GestÃ£o de Senhas</strong> <a class="header-anchor" href="#_1-seguranca-gestao-de-senhas" aria-label="Permalink to â€œ1. SeguranÃ§a - GestÃ£o de Senhasâ€">â€‹</a></h3><p>âŒ <strong>NÃƒO FAZER:</strong> Armazenar senhas em texto plano</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âŒ RUIM</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">admin_password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin123&quot;</span></span></code></pre></div><p>âœ… <strong>FAZER:</strong> Usar Ansible Vault</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Criar arquivo com variÃ¡veis sensÃ­veis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group_vars/monitoring/vault.yml</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> EOF</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">vault_grafana_password: &quot;senha_segura_aqui&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Encriptar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-vault</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> encrypt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> group_vars/monitoring/vault.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Usar no playbook</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Setup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Grafana</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  set_fact:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    grafana_password:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;{{ vault_grafana_password }}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Executar com prompt de senha</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --ask-vault-pass</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ou usar arquivo de senha</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --vault-password-file=.vault_pass</span></span></code></pre></div><h3 id="_2-idempotencia" tabindex="-1">2. <strong>IdempotÃªncia</strong> <a class="header-anchor" href="#_2-idempotencia" aria-label="Permalink to â€œ2. IdempotÃªnciaâ€">â€‹</a></h3><p>âœ… <strong>AÃ‡ÃƒO:</strong> As tasks devem ser idempotentes (mesmos resultados ao executar mÃºltiplas vezes)</p><p><strong>Atual:</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Subir stack de monitoramento</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docker compose up -d</span></span></code></pre></div><p><strong>Melhorado (Idempotente):</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Subir stack de monitoramento</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  community.docker.docker_compose</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    project_src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">present</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_dir.stat.exists</span></span></code></pre></div><h3 id="_3-nomeacao-descritiva" tabindex="-1">3. <strong>NomeaÃ§Ã£o Descritiva</strong> <a class="header-anchor" href="#_3-nomeacao-descritiva" aria-label="Permalink to â€œ3. NomeaÃ§Ã£o Descritivaâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Nomes claros e estruturados para tasks</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Criar diretÃ³rio do projeto: {{ project_path }}&quot;</span></span></code></pre></div><h3 id="_4-tratamento-de-erros" tabindex="-1">4. <strong>Tratamento de Erros</strong> <a class="header-anchor" href="#_4-tratamento-de-erros" aria-label="Permalink to â€œ4. Tratamento de Errosâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Capturar e lidar com erros apropriadamente</p><p><strong>Exemplo no projeto:</strong></p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Parar e remover containers</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docker compose down -v</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    chdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_dir.stat.exists</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  register</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">destroy_output</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  failed_when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # NÃ£o falha se comando falha</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  changed_when</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&#39;Removing&#39; in destroy_output.stdout&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Define quando hÃ¡ mudanÃ§a</span></span></code></pre></div><h3 id="_5-uso-de-handlers-para-reinicializacoes" tabindex="-1">5. <strong>Uso de Handlers para ReinicializaÃ§Ãµes</strong> <a class="header-anchor" href="#_5-uso-de-handlers-para-reinicializacoes" aria-label="Permalink to â€œ5. Uso de Handlers para ReinicializaÃ§Ãµesâ€">â€‹</a></h3><p>âŒ <strong>Atual:</strong> Task executa sempre</p><p>âœ… <strong>Melhorado:</strong> Usar handlers</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Atualizar config Prometheus</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">prometheus.yml.j2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    dest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}/prometheus/prometheus.yml&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  notify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Restart Prometheus&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Restart Prometheus</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  command</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">docker compose restart prometheus</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    chdir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  listen</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Restart Prometheus&quot;</span></span></code></pre></div><h3 id="_6-organizacao-com-tags" tabindex="-1">6. <strong>OrganizaÃ§Ã£o com Tags</strong> <a class="header-anchor" href="#_6-organizacao-com-tags" aria-label="Permalink to â€œ6. OrganizaÃ§Ã£o com Tagsâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Adicionar tags para seletividade</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Criar diretÃ³rios</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  file</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    path</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ item }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">directory</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}/prometheus&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">setup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">directories</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Renderizar templates</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ item.src }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    dest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ item.dest }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  loop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - { </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;docker-compose.yml.j2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}/docker-compose.yml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - { </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">src</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prometheus.yml.j2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">dest</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ project_path }}/prometheus/prometheus.yml&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">setup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">templates</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Executar apenas tags especÃ­ficas</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ansible-playbook playbook_create.yml --tags setup,templates</span></span></code></pre></div><h3 id="_7-variaveis-bem-estruturadas" tabindex="-1">7. <strong>VariÃ¡veis Bem Estruturadas</strong> <a class="header-anchor" href="#_7-variaveis-bem-estruturadas" aria-label="Permalink to â€œ7. VariÃ¡veis Bem Estruturadasâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Usar dicionÃ¡rios e listas estruturadas</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># âœ… BOM</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">containers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    image</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prom/prometheus:latest&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    port</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9090</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ip_address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;172.30.0.10&quot;</span></span></code></pre></div><p>âœ… <strong>FAZER:</strong> Validar variÃ¡veis obrigatÃ³rias</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Validar variÃ¡veis obrigatÃ³rias</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    that</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_name is defined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">project_path is defined</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">containers is defined</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    fail_msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;VariÃ¡veis obrigatÃ³rias nÃ£o definidas&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  tags</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">validate</span></span></code></pre></div><h3 id="_8-documentacao-no-codigo" tabindex="-1">8. <strong>DocumentaÃ§Ã£o no CÃ³digo</strong> <a class="header-anchor" href="#_8-documentacao-no-codigo" aria-label="Permalink to â€œ8. DocumentaÃ§Ã£o no CÃ³digoâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Comentar tasks complexas</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Criar a rede Docker com subnet especÃ­fica para evitar conflitos</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># com outras redes e permitir IPs fixos para containers</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Criar rede Docker para monitoramento</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  community.docker.docker_network</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ docker_network.name }}&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    driver</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">bridge</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    ipam_config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">subnet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;{{ docker_network.subnet }}&quot;</span></span></code></pre></div><h3 id="_9-versionamento-de-roles" tabindex="-1">9. <strong>Versionamento de Roles</strong> <a class="header-anchor" href="#_9-versionamento-de-roles" aria-label="Permalink to â€œ9. Versionamento de Rolesâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Usar requirements.yml para gerenciar roles externas</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># roles/requirements.yml</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">roles</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">geerlingguy.docker</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.0.1</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-galaxy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> roles/requirements.yml</span></span></code></pre></div><h3 id="_10-logging-e-auditoria" tabindex="-1">10. <strong>Logging e Auditoria</strong> <a class="header-anchor" href="#_10-logging-e-auditoria" aria-label="Permalink to â€œ10. Logging e Auditoriaâ€">â€‹</a></h3><p>âœ… <strong>FAZER:</strong> Habilitar logs</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># No ansible.cfg</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[defaults]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log_path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./ansible.log</span></span></code></pre></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ver logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tail</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ansible.log</span></span></code></pre></div><hr><h2 id="ğŸ“Š-estrutura-recomendada-para-producao" tabindex="-1">ğŸ“Š Estrutura Recomendada para ProduÃ§Ã£o <a class="header-anchor" href="#ğŸ“Š-estrutura-recomendada-para-producao" aria-label="Permalink to â€œğŸ“Š Estrutura Recomendada para ProduÃ§Ã£oâ€">â€‹</a></h2><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>monitoring-ansible/</span></span>
<span class="line"><span>â”œâ”€â”€ ansible.cfg</span></span>
<span class="line"><span>â”œâ”€â”€ inventory/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ hosts.ini</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ group_vars/</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ all.yml</span></span>
<span class="line"><span>â”‚   â”‚   â”œâ”€â”€ monitoring/</span></span>
<span class="line"><span>â”‚   â”‚   â”‚   â”œâ”€â”€ vault.yml          # â† VariÃ¡veis sensÃ­veis encriptadas</span></span>
<span class="line"><span>â”‚   â”‚   â”‚   â””â”€â”€ vars.yml</span></span>
<span class="line"><span>â”‚   â”‚   â””â”€â”€ production/</span></span>
<span class="line"><span>â”‚   â”‚       â””â”€â”€ vars.yml</span></span>
<span class="line"><span>â”‚   â””â”€â”€ host_vars/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ localhost.yml</span></span>
<span class="line"><span>â”œâ”€â”€ roles/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ requirements.yml</span></span>
<span class="line"><span>â”‚   â””â”€â”€ monitoring/</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ README.md</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ meta/</span></span>
<span class="line"><span>â”‚       â”‚   â””â”€â”€ main.yml</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ defaults/</span></span>
<span class="line"><span>â”‚       â”‚   â””â”€â”€ main.yml</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ tasks/</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ templates/</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ files/</span></span>
<span class="line"><span>â”‚       â”œâ”€â”€ handlers/</span></span>
<span class="line"><span>â”‚       â””â”€â”€ tests/</span></span>
<span class="line"><span>â”‚           â””â”€â”€ test.yml</span></span>
<span class="line"><span>â”œâ”€â”€ playbooks/</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ create.yml</span></span>
<span class="line"><span>â”‚   â”œâ”€â”€ destroy.yml</span></span>
<span class="line"><span>â”‚   â””â”€â”€ validate.yml</span></span>
<span class="line"><span>â”œâ”€â”€ .vault_pass                  # â† Nunca committar!</span></span>
<span class="line"><span>â”œâ”€â”€ .gitignore</span></span>
<span class="line"><span>â””â”€â”€ README.md</span></span></code></pre></div><hr><h2 id="ğŸ›-troubleshooting" tabindex="-1">ğŸ› Troubleshooting <a class="header-anchor" href="#ğŸ›-troubleshooting" aria-label="Permalink to â€œğŸ› Troubleshootingâ€">â€‹</a></h2><h3 id="problema-variaveis-nao-definidas" tabindex="-1">Problema: &quot;VariÃ¡veis nÃ£o definidas&quot; <a class="header-anchor" href="#problema-variaveis-nao-definidas" aria-label="Permalink to â€œProblema: &quot;VariÃ¡veis nÃ£o definidas&quot;â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SoluÃ§Ã£o: Testar variÃ¡veis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> test-vars.yml</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Debug detalhado</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ansible-playbook</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> playbook_create.yml</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -vvv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> variable</span></span></code></pre></div><h3 id="problema-docker-compose-command-not-found" tabindex="-1">Problema: &quot;Docker compose command not found&quot; <a class="header-anchor" href="#problema-docker-compose-command-not-found" aria-label="Permalink to â€œProblema: &quot;Docker compose command not found&quot;â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SoluÃ§Ã£o: Verificar instalaÃ§Ã£o</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Se nÃ£o tiver, instalar</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-compose-plugin</span></span></code></pre></div><h3 id="problema-permission-denied-ao-usar-docker" tabindex="-1">Problema: &quot;Permission denied ao usar Docker&quot; <a class="header-anchor" href="#problema-permission-denied-ao-usar-docker" aria-label="Permalink to â€œProblema: &quot;Permission denied ao usar Docker&quot;â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SoluÃ§Ã£o: Adicionar usuÃ¡rio ao grupo docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -aG</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $USER</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">newgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ou usar become: true no playbook</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Subir</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stack</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  command</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  become:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span></span></code></pre></div><h3 id="problema-containers-nao-iniciam" tabindex="-1">Problema: &quot;Containers nÃ£o iniciam&quot; <a class="header-anchor" href="#problema-containers-nao-iniciam" aria-label="Permalink to â€œProblema: &quot;Containers nÃ£o iniciam&quot;â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verificar logs</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Validar docker-compose.yml</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ~/monitoring/docker-compose.yml</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Verificar recursos disponÃ­veis</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> df</span></span></code></pre></div><h3 id="problema-ports-already-in-use" tabindex="-1">Problema: &quot;Ports already in use&quot; <a class="header-anchor" href="#problema-ports-already-in-use" aria-label="Permalink to â€œProblema: &quot;Ports already in use&quot;â€">â€‹</a></h3><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Encontrar processo usando porta 3000</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsof</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> :3000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Liberar porta ou mudar em group_vars/all.yml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># containers.grafana.host_port: 3001</span></span></code></pre></div><hr><h2 id="ğŸ“š-referencias-externas" tabindex="-1">ğŸ“š ReferÃªncias Externas <a class="header-anchor" href="#ğŸ“š-referencias-externas" aria-label="Permalink to â€œğŸ“š ReferÃªncias Externasâ€">â€‹</a></h2><ul><li><a href="https://docs.ansible.com/" target="_blank" rel="noreferrer">DocumentaÃ§Ã£o Ansible</a></li><li><a href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html" target="_blank" rel="noreferrer">Ansible Best Practices</a></li><li><a href="https://compose-spec.io/" target="_blank" rel="noreferrer">Docker Compose Specification</a></li><li><a href="https://prometheus.io/docs/" target="_blank" rel="noreferrer">Prometheus Documentation</a></li><li><a href="https://grafana.com/docs/" target="_blank" rel="noreferrer">Grafana Documentation</a></li><li><a href="https://docs.ansible.com/ansible/latest/user_guide/vault.html" target="_blank" rel="noreferrer">Ansible Vault</a></li></ul><hr><h2 id="ğŸ“-checklist-de-implantacao" tabindex="-1">ğŸ“ Checklist de ImplantaÃ§Ã£o <a class="header-anchor" href="#ğŸ“-checklist-de-implantacao" aria-label="Permalink to â€œğŸ“ Checklist de ImplantaÃ§Ã£oâ€">â€‹</a></h2><ul><li>[ ] Instalar Ansible 3.0+</li><li>[ ] Instalar Docker e Docker Compose</li><li>[ ] Clonar/baixar o projeto</li><li>[ ] Revisar <code>group_vars/all.yml</code> e ajustar conforme necessÃ¡rio</li><li>[ ] Validar sintaxe: <code>ansible-playbook --syntax-check playbook_create.yml</code></li><li>[ ] Testar conectividade: <code>ansible all -m ping</code></li><li>[ ] Executar dry-run: <code>ansible-playbook playbook_create.yml --check</code></li><li>[ ] Executar playbook: <code>ansible-playbook playbook_create.yml</code></li><li>[ ] Validar containers: <code>docker ps</code></li><li>[ ] Acessar Prometheus e Grafana</li><li>[ ] Configurar dashboards no Grafana</li><li>[ ] Documentar customizaÃ§Ãµes</li><li>[ ] Setup de backup de volumes</li><li>[ ] Implementar monitoramento e alertas</li></ul><hr><h2 id="ğŸ“-suporte-e-contribuicoes" tabindex="-1">ğŸ“ Suporte e ContribuiÃ§Ãµes <a class="header-anchor" href="#ğŸ“-suporte-e-contribuicoes" aria-label="Permalink to â€œğŸ“ Suporte e ContribuiÃ§Ãµesâ€">â€‹</a></h2><p>Para dÃºvidas, problemas ou sugestÃµes, consulte:</p><ul><li>DocumentaÃ§Ã£o do projeto (este arquivo)</li><li>Logs do Ansible: <code>ansible.log</code></li><li>Logs dos containers: <code>docker compose logs</code></li></ul><p><strong>Ãšltima atualizaÃ§Ã£o:</strong> 27 de janeiro de 2026</p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/Ansible/index.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>PÃ¡gina Anterior</span><span class="title" data-v-e257564d>Projetos e Exemplos</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/Ansible/comandos.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>PrÃ³xima PÃ¡gina</span><span class="title" data-v-e257564d>Comandos Ansible</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"ansible_comandos.md\":\"BPJGuNMS\",\"ansible_index.md\":\"BRk8ovWK\",\"ansible_instalacao.md\":\"DYStZxH1\",\"ansible_modulos.md\":\"BnPjgisF\",\"ansible_playbook.md\":\"C6JX9x8w\",\"ansible_projects_monitoringwithdockercomposer_readme.md\":\"DGd7cPdb\",\"ansible_roles.md\":\"DkUKMo1E\",\"api-examples.md\":\"BVQkKuEM\",\"aws_cli_configuracao_profile_iam.md\":\"Ddn7OK2S\",\"aws_index.md\":\"B1sL0uqo\",\"index.md\":\"BpmguDCg\",\"markdown-examples.md\":\"InernQbK\",\"terraform_ec2_index.md\":\"D_az70e0\",\"terraform_ec2_instÃ¢ncia ec2 com acesso via ssm (sem ssh).md\":\"B8ffILUc\",\"terraform_iam_create-users.md\":\"NR9DcBkF\",\"terraform_iam_index.md\":\"QWU35-Qe\",\"terraform_index.md\":\"BHGdEapA\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"DocumentaÃ§Ã£o Geral\",\"description\":\"Estudos Diversos em Tecnologia\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"InÃ­cio\",\"link\":\"/\"},{\"text\":\"Docs\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"Ansible\",\"items\":[{\"collapsed\":true,\"rel\":\"noopener noreferrer\",\"text\":\"Projetos e Exemplos\",\"link\":\"/Ansible/index.md\",\"items\":[{\"text\":\"Stack de Monitoramento\",\"link\":\"/Ansible/Projects/MonitoringWithDockerComposer/README.md\"}]},{\"text\":\"Comandos Ansible\",\"link\":\"/Ansible/comandos.md\"}]},{\"text\":\"AWS\",\"items\":[{\"text\":\"ConfiguraÃ§Ã£o CLI AWS\",\"link\":\"/aws/index\"}]},{\"text\":\"Terraform\",\"items\":[{\"text\":\"InstalaÃ§Ã£o Terraform\",\"link\":\"/terraform/index\"},{\"text\":\"LanÃ§ar InstÃ¢ncia EC2\",\"link\":\"/terraform/EC2/index\"}]}],\"docFooter\":{\"prev\":\"PÃ¡gina Anterior\",\"next\":\"PrÃ³xima PÃ¡gina\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>